<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Empréstimos de Livros</title>
  <style>
    body { font-family: Arial; margin: 20px; background: #f4f4f4; }
    h1 { text-align: center; }
    form, table { background: #fff; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    input, select { padding: 8px; margin: 5px; width: calc(100% - 20px); }
    button { padding: 10px 15px; background: #007bff; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 10px; border-bottom: 1px solid #ccc; text-align: left; }
    .suspenso { background-color: #f8d7da; }
    .sucesso {
  background-color: #d4edda;
  color: #155724;
  padding: 10px;
  border-left: 5px solid #28a745;
  border-radius: 4px;
  margin-top: 10px;
}

.erro {
  background-color: #f8d7da;
  color: #721c24;
  padding: 10px;
  border-left: 5px solid #dc3545;
  border-radius: 4px;
  margin-top: 10px;
}

nav {
  background-color: #007bff;
  padding: 10px 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  color: white;
}
.logo {
  font-size: 1.5em;
  font-weight: bold;
}
.menu {
  display: flex;
  gap: 20px;
}
.menu a {
  color: white;
  text-decoration: none;
  font-weight: bold;
}
.menu a:hover {
  text-decoration: underline;
}

  </style>
</head>
<body>
  <nav>
    <div class="logo">Biblioteca+ Soluções</div>
    <div class="menu">
      <a href="index.html">index</a>
      <a href="Modulo1.html">Modulo 1</a>
      <a href="Modulo 2.html">Modulo 2</a>
      <a href="Modulo3.html">Modulo 3</a>
      <a href="Modulo 4.html">Modulo 4</a>
      <a href="Modulo5.html">Modulo 5</a>
    </div>
  </nav>
      
  <h1>Controle de Empréstimos</h1>
  <form id="formEmprestimo">
    <input type="text" id="usuario" placeholder="Nome completo do usuário" required />
    <input type="text" id="matricula" placeholder="Matrícula do usuário" required />
    <input type="text" id="livro" placeholder="Título do item emprestado" required />
    <select id="tipo" required>
      <option value="" disabled selected>Selecione o tipo de item</option>
      <option value="livro">Livro</option>
      <option value="revista">Revista</option>
      <option value="eletronico">Eletrônico</option>
    </select>
    <button type="submit">Registrar Empréstimo</button>
  </form>
  

  <table>
    <thead>
      <tr><th>Usuário</th><th>Matrícula</th><th>Item</th><th>Tipo</th><th>Data Prevista</th><th>Status</th><th>Multa</th><th>Ações</th></tr>
    </thead>
    <tbody id="listaEmprestimos"></tbody>
  </table>

  <script>
    function mostrarMensagem(texto, tipo) {
  const div = document.getElementById('mensagem');
  div.className = tipo === 'sucesso' ? 'sucesso' : 'erro';
  div.textContent = texto;
  setTimeout(() => {
    div.textContent = '';
    div.className = '';
  }, 4000);
}

    const form = document.getElementById('formEmprestimo');
    const lista = document.getElementById('listaEmprestimos');
    let emprestimos = [
  { usuario: 'João', matricula: '2023001', livro: 'Alice no País das Maravilhas', tipo: 'livro', dataPrevista: '2025-10-01', status: 'Em andamento', multa: 0 },
  { usuario: 'João', matricula: '2023001', livro: 'O Pequeno Príncipe', tipo: 'livro', dataPrevista: '2025-10-03', status: 'Em andamento', multa: 0 },
  { usuario: 'João', matricula: '2023001', livro: 'Tablet Samsung', tipo: 'eletronico', dataPrevista: '2025-10-05', status: 'Em andamento', multa: 0 },
  { usuario: 'Maria', matricula: '2023002', livro: 'Notebook Dell', tipo: 'eletronico', dataPrevista: '2025-10-02', status: 'Em andamento', multa: 0 },
  { usuario: 'Maria', matricula: '2023002', livro: 'Projetor Epson', tipo: 'eletronico', dataPrevista: '2025-10-04', status: 'Em andamento', multa: 0 },
  { usuario: 'Ana', matricula: '2023003', livro: 'Capitães da Areia', tipo: 'livro', dataPrevista: '2025-09-25', status: 'Em andamento', multa: 0 },
  { usuario: 'Carlos', matricula: '2023004', livro: 'Revista Ciência Hoje', tipo: 'revista', dataPrevista: '2025-10-06', status: 'Em andamento', multa: 0 },
  { usuario: 'Fernanda', matricula: '2023005', livro: 'Kindle Amazon', tipo: 'eletronico', dataPrevista: '2025-10-07', status: 'Em andamento', multa: 0 },
  { usuario: 'Fernanda', matricula: '2023005', livro: 'Livro: 1984', tipo: 'livro', dataPrevista: '2025-10-08', status: 'Em andamento', multa: 0 },
  { usuario: 'Lucas', matricula: '2023006', livro: 'Livro: A Revolução dos Bichos', tipo: 'livro', dataPrevista: '2025-09-28', status: 'Em andamento', multa: 0 }
    ];
    let suspensos = {};

    form.addEventListener('submit', function(e) {
      e.preventDefault();
      const usuario = document.getElementById('usuario').value.trim();
      const matricula = document.getElementById('matricula').value.trim();
      const livro = document.getElementById('livro').value.trim();
      const tipo = document.getElementById('tipo').value;

      if (suspensos[matricula]) {
        alert(`Usuário ${usuario} está suspenso.`);
        return;
      }

      const ativos = emprestimos.filter(e => e.matricula === matricula && e.status === 'Em andamento');
      const total = ativos.length;
      const eletronicos = ativos.filter(e => e.tipo === 'eletronico').length;

      if (total >= 5) {
        alert('Limite de 5 itens por usuário.');
        return;
      }
      if (tipo === 'eletronico' && eletronicos >= 2) {
        alert('Limite de 2 eletrônicos por usuário.');
        return;
      }

      const hoje = new Date();
      const prazo = tipo === 'eletronico' ? 7 : 15;
      const dataPrevista = new Date(hoje.getTime() + prazo * 86400000).toISOString().split('T')[0];

      emprestimos.push({ usuario, matricula, livro, tipo, dataPrevista, status: 'Em andamento', multa: 0 });
      form.reset();
      renderizar();
    });

    function calcularMulta(dataPrevista) {
      const hoje = new Date();
      const prevista = new Date(dataPrevista);
      const dias = Math.floor((hoje - prevista) / 86400000);
      return dias > 0 ? dias * 2 : 0;
    }

    function renderizar() {
      lista.innerHTML = '';
      emprestimos.forEach((e, i) => {
        if (e.status === 'Em andamento') {
          e.multa = calcularMulta(e.dataPrevista);
          if (e.multa >= 20) {
            suspensos[e.matricula] = true;
            e.status = 'Suspenso';
          }
        }

        const tr = document.createElement('tr');
        if (e.status === 'Suspenso') tr.classList.add('suspenso');
        tr.innerHTML = `
          <td>${e.usuario}</td><td>${e.matricula}</td><td>${e.livro}</td><td>${e.tipo}</td>
          <td>${e.dataPrevista}</td><td>${e.status}</td><td>R$ ${e.multa.toFixed(2)}</td>
          <td>
            ${e.status === 'Em andamento' ? `<button onclick="devolver(${i})">Devolver</button>` : ''}
            <button onclick="excluir(${i})">Excluir</button>
          </td>
        `;
        lista.appendChild(tr);
      });
    }

    function devolver(i) {
      emprestimos[i].status = 'Devolvido';
      emprestimos[i].multa = 0;
      renderizar();
    }

    function excluir(i) {
      emprestimos.splice(i, 1);
      renderizar();
    }

    renderizar();
  </script>
</body>
</html>
